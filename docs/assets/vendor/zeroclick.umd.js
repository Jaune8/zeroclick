!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).zeroclick=t()}(this,function(){var e={on:"a",timeout:600,preventClick:!0,onEngage:()=>{},onDispatch:()=>{},onCancel:()=>{}};return new class{init(t){this._props={...e,...t},this._navigating=!1,this._nodelist="string"==typeof this._props.on?[...document.querySelectorAll(this._props.on)]:[...this._props.on],this._nodelist.forEach(e=>{e.handler={engage:()=>{this._engage(e)},cancel:()=>{this._cancel(e)},click:e=>{this._click(e)}},e.addEventListener("mouseenter",e.handler.engage),e.addEventListener("mouseleave",e.handler.cancel),e.addEventListener("click",e.handler.click)})}destroy(){this._nodelist.forEach(e=>{e.removeEventListener("mouseenter",e.handler.engage),e.removeEventListener("mouseleave",e.handler.cancel),e.removeEventListener("click",e.handler.click)})}refresh(){this.destroy(),this.init(this._props)}_engage(e){this._navigating||(this._props.onEngage({target:e,url:e.href}),e.dispatchEvent(new CustomEvent("engage")),e.setAttribute("data-zeroclick","engage"),this._props.current={target:e,promise:new Promise((e,t)=>{"function"==typeof this._props.await?(this._props.await(e,t),this._worker=t):this._worker=setTimeout(e,this._props.timeout)}).then(()=>{this._dispatch(e)}).catch(()=>{this._reset()})})}_dispatch(e){this._navigating=!0,this._props.onDispatch({target:e,url:e.href}),e.dispatchEvent(new CustomEvent("dispatch")),e.setAttribute("data-zeroclick","dispatch"),e.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0})),this._reset()}_cancel(e){this._navigating||void 0===this._worker||("function"==typeof this._worker&&this._worker("cancel"),"number"==typeof this._worker&&clearTimeout(this._worker),this._props.onCancel({target:e,url:e.href}),e.dispatchEvent(new CustomEvent("cancel")),e.setAttribute("data-zeroclick","cancel"))}_click(e){if(!this._navigating&&this._props.preventClick)return e.preventDefault(),void e.stopPropagation();this._cancel(e.target),this._navigating=!0}_reset(){delete this._worker}get props(){return this._props}}});
